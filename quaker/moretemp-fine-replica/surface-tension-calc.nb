(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63854,       1689]
NotebookOptionsPosition[     60222,       1565]
NotebookOutlinePosition[     60558,       1580]
CellTagsIndexPosition[     60515,       1577]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setting up functional forms and doing analytical integration", "Section",
 CellChangeTimes->{{3.708801591604312*^9, 3.708801603604165*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]", "=", 
  RowBox[{
   RowBox[{"Log", "[", "0.00022285", "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "81"}], "*", "1.4337"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.708710967011692*^9, 3.708711028391526*^9}, {
  3.7087110592399807`*^9, 3.708711060375593*^9}, {3.708711351145954*^9, 
  3.708711352401607*^9}, {3.708720735328027*^9, 3.708720742287299*^9}, {
  3.708721109402152*^9, 3.708721110193893*^9}}],

Cell[BoxData["0.07241051736611485`"], "Output",
 CellChangeTimes->{{3.708710984187728*^9, 3.7087110291670513`*^9}, 
   3.708711061126622*^9, 3.708711353484891*^9, {3.708720743152379*^9, 
   3.7087207467492027`*^9}, 3.708721112906499*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[Gamma]", "]"}]], "Input",
 CellChangeTimes->{{3.708801635448503*^9, 3.708801637740528*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", ">", "0"}], "&&", 
     RowBox[{"f", "<", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708461214406199*^9, 3.708461256385807*^9}, {
  3.708461479074489*^9, 3.7084614818746567`*^9}, {3.708955214401737*^9, 
  3.7089552217772703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p1", "[", 
    RowBox[{"\[Theta]_", ",", "n_"}], "]"}], "=", 
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Theta]", "-", "a"}], ")"}], "2"]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"v1", "/", "n"}]}], ")"}]}], "]"}], 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]", " ", 
       FractionBox["v1", "n"]}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.7084423467711687`*^9, 3.7084425032307177`*^9}, {
  3.70844262856714*^9, 3.7084426317354183`*^9}, {3.708460943047237*^9, 
  3.708460967023381*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"p2", "[", 
    RowBox[{"\[Theta]_", ",", "n_"}], "]"}], "=", 
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"\[Theta]", "-", "b"}], ")"}], "2"]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"v2", "/", "n"}]}], ")"}]}], "]"}], 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"2", "\[Pi]", " ", 
       FractionBox["v2", "n"]}], ")"}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.708442506811657*^9, 3.708442559406506*^9}, {
  3.708442633983499*^9, 3.708442635287051*^9}, {3.708460972599597*^9, 
  3.70846097650336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L1", "[", "f_", "]"}], "=", 
    RowBox[{"l1", "*", "2", "\[Pi]", " ", "f"}]}], ";", 
   RowBox[{"L2", "=", "l1"}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.708443280076234*^9, 3.708443338131802*^9}, {
  3.708804412312077*^9, 3.708804416310534*^9}, {3.708805311437644*^9, 
  3.70880537628533*^9}, {3.708805571031345*^9, 3.708805581855006*^9}, {
  3.708805905593546*^9, 3.708805911248929*^9}, {3.708806574974324*^9, 
  3.708806576861215*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"surfen1", "[", "f_", "]"}], "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "1.4337"}], "*", 
     RowBox[{"L1", "[", "f", "]"}], "*", "\[Gamma]"}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"surfen2", "[", "f_", "]"}], "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "1.4337"}], "*", "L2", "*", "\[Gamma]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"surfen1", "[", "2", "]"}]}], "Input",
 CellChangeTimes->{{3.70871111220121*^9, 3.7087111497842417`*^9}, {
   3.708711197273581*^9, 3.708711197920649*^9}, {3.708711298514249*^9, 
   3.708711301978117*^9}, {3.708803873500004*^9, 3.708803886227303*^9}, {
   3.708805356109004*^9, 3.708805360117323*^9}, 3.708805586527059*^9, {
   3.708805917105032*^9, 3.7088059321207237`*^9}, {3.70880659054937*^9, 
   3.708806590917527*^9}}],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", "18.016405549806745`"}], " ", "l1", " ", 
   "\[Gamma]"}]]], "Output",
 CellChangeTimes->{{3.70880387813416*^9, 3.708803886697681*^9}, 
   3.708804422158141*^9, {3.708805356571793*^9, 3.7088053782140827`*^9}, 
   3.708805586942795*^9, 3.708805934073449*^9, {3.708806586360243*^9, 
   3.708806591679937*^9}, 3.708955242915495*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"surfconst", " ", "=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "1.4337"}], "*", "81", "*", "\[Gamma]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7087113142535458`*^9, 3.708711339858696*^9}, 
   3.7088016623252172`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t1", "=", 
  RowBox[{"p1", "[", 
   RowBox[{
    SubscriptBox["\[Theta]", "1"], ",", 
    RowBox[{"f", "*", "N"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708442594829122*^9, 3.708442610200844*^9}, {
  3.708442643302607*^9, 3.708442654767206*^9}, {3.70844280864742*^9, 
  3.708442809215605*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"f", " ", "N", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", 
         SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}], 
     RowBox[{"2", " ", "v1"}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    FractionBox["v1", 
     RowBox[{"f", " ", "N"}]]]}]]], "Output",
 CellChangeTimes->{
  3.70844261142382*^9, {3.7084426442919073`*^9, 3.708442656354084*^9}, 
   3.708442810255599*^9, 3.708446227348057*^9, 3.708459945546928*^9, 
   3.708460982250543*^9, 3.70846148618935*^9, 3.708711361440288*^9, 
   3.708720746905346*^9, 3.708721113088101*^9, 3.708801665671802*^9, 
   3.708955246798209*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t2", "=", 
  RowBox[{"p2", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Theta]", "-", 
      RowBox[{"f", "*", 
       SubscriptBox["\[Theta]", "1"]}]}], 
     RowBox[{"1", "-", "f"}]], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "f"}], ")"}], "*", "N"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7084426576233253`*^9, 3.708442697518866*^9}, {
  3.70844279869562*^9, 3.7084428134315233`*^9}, {3.708459909872469*^9, 
  3.708459920567728*^9}, {3.708711364818054*^9, 3.708711365881879*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "N", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "b"}], "+", 
         FractionBox[
          RowBox[{"\[Theta]", "-", 
           RowBox[{"f", " ", 
            SubscriptBox["\[Theta]", "1"]}]}], 
          RowBox[{"1", "-", "f"}]]}], ")"}], "2"]}], 
     RowBox[{"2", " ", "v2"}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    FractionBox["v2", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "N"}]]]}]]], "Output",
 CellChangeTimes->{{3.7084427990587997`*^9, 3.708442813914152*^9}, 
   3.708446227417468*^9, 3.708459947562901*^9, 3.708460984459827*^9, 
   3.708461486261283*^9, 3.708711366823798*^9, 3.70872074693108*^9, 
   3.708721113115794*^9, 3.708801666597958*^9, 3.708955248204576*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"i1", "=", 
  RowBox[{"t1", "*", "t2"}]}]], "Input",
 CellChangeTimes->{{3.708442865946128*^9, 3.708442867375826*^9}, {
   3.708461069584523*^9, 3.708461092327903*^9}, 3.708873107020227*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"f", " ", "N", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "a"}], "+", 
          SubscriptBox["\[Theta]", "1"]}], ")"}], "2"]}], 
      RowBox[{"2", " ", "v1"}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "N", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "b"}], "+", 
         FractionBox[
          RowBox[{"\[Theta]", "-", 
           RowBox[{"f", " ", 
            SubscriptBox["\[Theta]", "1"]}]}], 
          RowBox[{"1", "-", "f"}]]}], ")"}], "2"]}], 
     RowBox[{"2", " ", "v2"}]]}]], 
  RowBox[{"2", " ", "\[Pi]", " ", 
   SqrtBox[
    FractionBox["v1", 
     RowBox[{"f", " ", "N"}]]], " ", 
   SqrtBox[
    FractionBox["v2", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "f"}], ")"}], " ", "N"}]]]}]]], "Output",
 CellChangeTimes->{
  3.708442867878296*^9, 3.708446227486837*^9, 3.708459949582323*^9, 
   3.708460985741658*^9, {3.708461071610186*^9, 3.7084610928227463`*^9}, 
   3.708461486333939*^9, 3.708711368091035*^9, 3.708720746957284*^9, 
   3.7087211131433067`*^9, 3.70880166808351*^9, 3.708873110825651*^9, 
   3.70895525014183*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"i2", "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "<", "1"}], ",", 
      RowBox[{"f", ">", "0"}]}], "}"}], ",", 
    RowBox[{"Integrate", "[", 
     RowBox[{"i1", ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["\[Theta]", "1"], ",", 
        RowBox[{"-", "Infinity"}], ",", " ", "Infinity"}], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708462733919589*^9, 3.708462770370977*^9}, {
  3.70880390581203*^9, 3.708803955052352*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"N", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "f"}], ")"}]}], "-", 
           RowBox[{"a", " ", "f"}], "+", "\[Theta]"}], ")"}], "2"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", " ", 
           RowBox[{"(", 
            RowBox[{"v1", "-", "v2"}], ")"}]}], "+", "v2"}], ")"}]}]]}]], 
    RowBox[{"2", " ", "\[Pi]", " ", 
     SqrtBox[
      FractionBox["v1", 
       RowBox[{
        RowBox[{"f", " ", "N"}], "-", 
        RowBox[{
         SuperscriptBox["f", "2"], " ", "N"}]}]]], " ", 
     SqrtBox[
      FractionBox["v2", "N"]], " ", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["f", "2"], " ", "N", " ", "v1"}], "+", 
        RowBox[{"f", " ", "N", " ", "v2"}], "-", 
        RowBox[{
         SuperscriptBox["f", "2"], " ", "N", " ", "v2"}]}], 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", "v1", " ", "v2"}], "-", 
        RowBox[{"2", " ", "f", " ", "\[Pi]", " ", "v1", " ", "v2"}]}]]]}]], 
   ",", 
   RowBox[{
    RowBox[{"Re", "[", 
     FractionBox[
      RowBox[{"N", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f", " ", 
          RowBox[{"(", 
           RowBox[{"v1", "-", "v2"}], ")"}]}], "+", "v2"}], ")"}]}], 
      RowBox[{"v1", " ", "v2"}]], "]"}], "\[GreaterEqual]", "0"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.708462765148623*^9, 3.708462776586404*^9}, 
   3.7087113747135563`*^9, 3.708720752075076*^9, 3.708721118355792*^9, 
   3.708801675361657*^9, {3.7088039409563923`*^9, 3.708803958057233*^9}, 
   3.70887316864804*^9, 3.708955301289818*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"FullSimplify", "[", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"N", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "f"}], ")"}]}], "-", 
           RowBox[{"a", " ", "f"}], "+", "\[Theta]"}], ")"}], "2"]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", " ", 
           RowBox[{"(", 
            RowBox[{"v1", "-", "v2"}], ")"}]}], "+", "v2"}], ")"}]}]]}]], 
    RowBox[{"2", " ", "\[Pi]", " ", 
     SqrtBox[
      FractionBox["v1", 
       RowBox[{
        RowBox[{"f", " ", "N"}], "-", 
        RowBox[{
         SuperscriptBox["f", "2"], " ", "N"}]}]]], " ", 
     SqrtBox[
      FractionBox["v2", "N"]], " ", 
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["f", "2"], " ", "N", " ", "v1"}], "+", 
        RowBox[{"f", " ", "N", " ", "v2"}], "-", 
        RowBox[{
         SuperscriptBox["f", "2"], " ", "N", " ", "v2"}]}], 
       RowBox[{
        RowBox[{"2", " ", "\[Pi]", " ", "v1", " ", "v2"}], "-", 
        RowBox[{"2", " ", "f", " ", "\[Pi]", " ", "v1", " ", "v2"}]}]]]}]], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7089553479670877`*^9, 3.70895535327911*^9}, {
  3.708956200736122*^9, 3.708956208656024*^9}, {3.708956320712633*^9, 
  3.708956322048992*^9}, {3.708956464802327*^9, 3.708956472007875*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"N", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "f"}], ")"}]}], "-", 
         RowBox[{"a", " ", "f"}], "+", "\[Theta]"}], ")"}], "2"]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", " ", 
         RowBox[{"(", 
          RowBox[{"v1", "-", "v2"}], ")"}]}], "+", "v2"}], ")"}]}]]}]], 
  RowBox[{
   SqrtBox[
    RowBox[{"2", " ", "\[Pi]"}]], " ", 
   SqrtBox[
    FractionBox["v1", 
     RowBox[{
      RowBox[{"f", " ", "N"}], "-", 
      RowBox[{
       SuperscriptBox["f", "2"], " ", "N"}]}]]], " ", 
   SqrtBox[
    FractionBox["v2", "N"]], " ", 
   SqrtBox[
    RowBox[{"f", " ", "N", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "v1"], "+", 
       FractionBox["f", 
        RowBox[{"v2", "-", 
         RowBox[{"f", " ", "v2"}]}]]}], ")"}]}]]}]]], "Output",
 CellChangeTimes->{3.708955354751507*^9, 3.70895632417866*^9, 
  3.7089565876689157`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TraditionalForm", "[", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"N", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "f"}], ")"}]}], "-", 
          RowBox[{"a", " ", "f"}], "+", "\[Theta]"}], ")"}], "2"]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f", " ", 
          RowBox[{"(", 
           RowBox[{"v1", "-", "v2"}], ")"}]}], "+", "v2"}], ")"}]}]]}]], 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    SqrtBox[
     FractionBox["v1", 
      RowBox[{
       RowBox[{"f", " ", "N"}], "-", 
       RowBox[{
        SuperscriptBox["f", "2"], " ", "N"}]}]]], " ", 
    SqrtBox[
     FractionBox["v2", "N"]], " ", 
    SqrtBox[
     RowBox[{"f", " ", "N", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "v1"], "+", 
        FractionBox["f", 
         RowBox[{"v2", "-", 
          RowBox[{"f", " ", "v2"}]}]]}], ")"}]}]]}]], "]"}]], "Input",
 CellChangeTimes->{{3.708956738546187*^9, 3.708956746809163*^9}}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"exp", "(", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"N", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"a", " ", "f"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{"f", "-", "1"}], ")"}]}], "+", "\[Theta]"}], ")"}], 
        "2"]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"f", " ", 
          RowBox[{"(", 
           RowBox[{"v1", "-", "v2"}], ")"}]}], "+", "v2"}], ")"}]}]]}], ")"}], 
   RowBox[{
    SqrtBox[
     RowBox[{"2", " ", "\[Pi]"}]], " ", 
    SqrtBox[
     FractionBox["v2", "N"]], " ", 
    SqrtBox[
     FractionBox["v1", 
      RowBox[{
       RowBox[{"f", " ", "N"}], "-", 
       RowBox[{
        SuperscriptBox["f", "2"], " ", "N"}]}]]], " ", 
    SqrtBox[
     RowBox[{"f", " ", "N", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["f", 
         RowBox[{"v2", "-", 
          RowBox[{"f", " ", "v2"}]}]], "+", 
        FractionBox["1", "v1"]}], ")"}]}]]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.708956748167458*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"i2", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"N", "\[Rule]", " ", "240"}], ",", 
     RowBox[{"a", "\[Rule]", 
      RowBox[{"-", "0.7218"}]}], " ", ",", 
     RowBox[{"v1", "\[Rule]", "0.01359"}], " ", ",", 
     RowBox[{"b", "\[Rule]", 
      RowBox[{"-", "0.2844"}]}], " ", ",", 
     RowBox[{"v2", "\[Rule]", "0.6769"}]}], " ", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.70887372904104*^9, 3.708873747752294*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"398.2533044077858`", " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"34.61164643982452`", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"0.6502057613168724`", "\[VeryThinSpace]", "+", 
          RowBox[{"1.`", " ", "f"}], "+", 
          RowBox[{"2.286236854138089`", " ", "\[Theta]"}]}], ")"}], "2"]}], 
      RowBox[{
       RowBox[{"-", "1.0204881578749`"}], "+", 
       RowBox[{"1.`", " ", "f"}]}]]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1.`"}], "+", "f"}], ")"}]}], 
   SqrtBox[
    RowBox[{"2810.683321711176`", "\[VeryThinSpace]", "-", 
     RowBox[{"2754.253736333639`", " ", "f"}]}]]]}]], "Output",
 CellChangeTimes->{{3.7088737364994*^9, 3.708873748469396*^9}, 
   3.708955363993514*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reading in data from MBAR and initialising arrays", "Section",
 CellChangeTimes->{{3.708801545100247*^9, 3.7088015552837543`*^9}}],

Cell["thlist = Range[-0.8, 0.2, 0.01];", "Text",
 CellChangeTimes->{{3.708462855328328*^9, 3.708462881708103*^9}, 
   3.708797562620829*^9}],

Cell["i = 4; Part[thlist, i]", "Text",
 CellChangeTimes->{{3.70846298650913*^9, 3.708462987980562*^9}, 
   3.708466873072303*^9, {3.708797547721723*^9, 3.708797569164521*^9}}],

Cell["\<\
##For [i = 1, i <= Length[thlist], i++, Print[ thlist[[i]]]; Print[ \
NIntegrate[i2 /. \[Theta] -> thlist[[i]], {f, 0, 1}] ] ]\
\>", "Text",
 CellChangeTimes->{{3.70846288446124*^9, 3.7084629121000147`*^9}, {
   3.70846294522827*^9, 3.708462982268277*^9}, {3.70846303738099*^9, 
   3.708463089156959*^9}, {3.708463133134552*^9, 3.708463148013434*^9}, {
   3.708466834031166*^9, 3.708466899494644*^9}, {3.7084669390717287`*^9, 
   3.7084669540466423`*^9}, {3.708466993399316*^9, 3.708466997735667*^9}, {
   3.708467032167163*^9, 3.708467042832591*^9}, 3.708525185422698*^9, {
   3.708721098246372*^9, 3.7087211039459953`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{
    "\"\<Replica-Exchange-Slab/quaker/moretemp-fine-replica/f_v_thz-351K.dat\>\
\"", ",", 
     RowBox[{"{", 
      RowBox[{"Number", ",", "Number"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708524349920965*^9, 3.708524377377195*^9}, {
  3.708524417129727*^9, 3.708524440113575*^9}, {3.70852464753364*^9, 
  3.708524692702085*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "[", 
  RowBox[{"[", 
   RowBox[{"50", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.708524697111197*^9, 3.708524722445075*^9}, {
  3.708524781403956*^9, 3.7085247912359*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.6198`"}]], "Output",
 CellChangeTimes->{{3.7085247010565367`*^9, 3.7085247227707663`*^9}, {
   3.708524783652693*^9, 3.708524791807719*^9}, 3.7087113931134863`*^9, 
   3.708720753947041*^9, 3.708721118458766*^9, 3.708799134467716*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"th", "=", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Sow", "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7087990155986757`*^9, 3.708799188860499*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptot", "=", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Sow", "[", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7087991948704567`*^9, 3.7087992173969603`*^9}, {
  3.708801478156049*^9, 3.70880148998764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pord", "=", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Sow", "[", 
        RowBox[{
         RowBox[{"p1", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "240"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "\[Rule]", 
            RowBox[{"-", "0.7218"}]}], ",", 
           RowBox[{"v1", "\[Rule]", "0.01359"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708798671887144*^9, 3.708798719873849*^9}, {
   3.708798755483859*^9, 3.7087988693389263`*^9}, 3.708801299341042*^9, 
   3.708801336675207*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pdisord", "=", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Sow", "[", 
        RowBox[{
         RowBox[{"p1", "[", 
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "240"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "\[Rule]", 
            RowBox[{"-", "0.2844"}]}], ",", 
           RowBox[{"v1", "\[Rule]", "0.6769"}]}], "}"}]}], "]"}]}], "]"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708798878907009*^9, 3.708798898362775*^9}, {
  3.7088013147708817`*^9, 3.7088013191388397`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"ptot", "-", 
    RowBox[{"0.02", "*", 
     RowBox[{"(", 
      RowBox[{"pord", "+", "pdisord"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708801350254549*^9, 3.7088014536195297`*^9}, {
  3.708801504484034*^9, 3.708801517627592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ynew", "=", 
   RowBox[{"Inner", "[", 
    RowBox[{"List", ",", "th", ",", "y", ",", "List"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.708802612202911*^9, 3.708802612802965*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "ynew", "]"}]], "Input",
 CellChangeTimes->{{3.708801404702992*^9, 3.7088014460679417`*^9}, {
  3.7088026169315434`*^9, 3.708802617235425*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.007333333333333334], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
      "]]}, {}}, {}},
  
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.8011, 0.1199}, {-0.009964276208249103, 
   0.006288299819814088}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.708801410908986*^9, 3.708801455305739*^9}, {
   3.708801499851777*^9, 3.70880151929818*^9}, 3.708802617528831*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"funcform", "[", 
   RowBox[{"gamma_", ",", "theta_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"surfen1", "[", "f", "]"}], "*", "i2"}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l1", "\[Rule]", "81"}], ",", " ", 
       RowBox[{"\[Theta]", "\[Rule]", " ", "theta"}], ",", 
       RowBox[{"\[Gamma]", "\[Rule]", "gamma"}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"f", ",", "0", ",", 
      FractionBox["1", 
       RowBox[{"2", "\[Pi]"}]]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708806211115492*^9, 3.708806336379668*^9}, {
   3.708806369180129*^9, 3.708806497652978*^9}, {3.70880659900572*^9, 
   3.708806846396592*^9}, 3.7088069467925253`*^9, {3.708806990696979*^9, 
   3.7088070266216803`*^9}, {3.708807125417509*^9, 3.708807148296708*^9}, {
   3.708807247634488*^9, 3.708807253369939*^9}, {3.7088081472480164`*^9, 
   3.7088082469205103`*^9}, {3.708808283608824*^9, 3.7088082904248943`*^9}, {
   3.708808321362027*^9, 3.708808324849351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"model", "[", "gamma_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"Sow", "[", 
        RowBox[{"funcform", "[", 
         RowBox[{"gamma", ",", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], "]"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708806954093094*^9, 3.7088069565113277`*^9}, {
  3.708808337809024*^9, 3.708808449833996*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NonlinearModelFit", "[", 
  RowBox[{"ynew", ",", " ", 
   RowBox[{"model", "[", "gamma", "]"}], ",", 
   RowBox[{"{", "gamma", "}"}], " ", ",", "theta"}], "]"}]], "Input",
 CellChangeTimes->{{3.708808453073462*^9, 3.7088084574338837`*^9}, {
  3.70880871413207*^9, 3.708808720211335*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \[NoBreak]\\!\\(\\*RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"7.588525787764529`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{FractionBox[RowBox[{RowBox[{\\\"-\\\", \\\"48.29938761664987`\\\"}], \
\\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"+\\\", RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \\\"\
\[RightSkeleton]\\\"}], \\\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]}]}], RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \\\"f\\\"}], \
\\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\")\\\"}]}]], RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
RowBox[{\\\"729.6644247671732`\\\", \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}]}]}]], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"1.0224602183046896`\\\", \\\
\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"2.0224602183046896`\\\", \
\\\" \\\", \\\"f\\\"}], \\\"+\\\", RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"f\\\", \\\"2\\\"]}]}], \\\")\\\"}], \\\" \\\", \
SqrtBox[FractionBox[RowBox[{\\\"1\\\", \\\"-\\\", \\\"f\\\"}], \
RowBox[{RowBox[{\\\"1.0204881578749`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\\\
\", RowBox[{\\\"2.0204881578749`\\\", \\\" \\\", \\\"f\\\"}], \\\"+\\\", \
RowBox[{\\\"1.`\\\", \\\" \\\", SuperscriptBox[\\\"f\\\", \\\"2\\\"]}]}]]]}], \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0224602183046896`\\\"}], \\\"+\\\", RowBox[{\
\\\"1.`\\\", \\\" \\\", \\\"f\\\"}]}]]}]\\)\[NoBreak] has evaluated to \
non-numerical values for all sampling points in the region with boundaries \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0.15915494309189535`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", ButtonNote -> \
\\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7088084946849957`*^9, 3.708808721099354*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \[NoBreak]\\!\\(\\*RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"7.588525787764529`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{FractionBox[RowBox[{RowBox[{\\\"-\\\", \\\"48.29938761664987`\\\"}], \
\\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"+\\\", RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \\\"\
\[RightSkeleton]\\\"}], \\\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]}]}], RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \\\"f\\\"}], \
\\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\")\\\"}]}]], RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
RowBox[{\\\"729.6644247671732`\\\", \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"5\\\", \\\"\[RightSkeleton]\\\"}]}]}]], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"1.0224602183046896`\\\", \\\
\"\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"2.0224602183046896`\\\", \
\\\" \\\", \\\"f\\\"}], \\\"+\\\", RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"f\\\", \\\"2\\\"]}]}], \\\")\\\"}], \\\" \\\", \
SqrtBox[FractionBox[RowBox[{\\\"1\\\", \\\"-\\\", \\\"f\\\"}], \
RowBox[{RowBox[{\\\"1.0204881578749`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\\\
\", RowBox[{\\\"2.0204881578749`\\\", \\\" \\\", \\\"f\\\"}], \\\"+\\\", \
RowBox[{\\\"1.`\\\", \\\" \\\", SuperscriptBox[\\\"f\\\", \\\"2\\\"]}]}]]]}], \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0224602183046896`\\\"}], \\\"+\\\", RowBox[{\
\\\"1.`\\\", \\\" \\\", \\\"f\\\"}]}]]}]\\)\[NoBreak] has evaluated to \
non-numerical values for all sampling points in the region with boundaries \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0.15915494309189535`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", ButtonNote -> \
\\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7088084946849957`*^9, 3.708808721134738*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \[NoBreak]\\!\\(\\*RowBox[{\\\"-\\\", \
FractionBox[RowBox[{\\\"7.588525787764529`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{FractionBox[RowBox[{RowBox[{\\\"-\\\", \\\"47.6101370399964`\\\"}], \
\\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"+\\\", RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"18\\\", \\\"\
\[RightSkeleton]\\\"}], \\\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}]}]}], RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \\\"f\\\"}], \
\\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\")\\\"}]}]], \\\"-\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}]], \\\
\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"1.0223564824318556`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"2.0223564824318556`\\\", \\\" \
\\\", \\\"f\\\"}], \\\"+\\\", RowBox[{\\\"1.`\\\", \\\" \\\", SuperscriptBox[\
\\\"f\\\", \\\"2\\\"]}]}], \\\")\\\"}], \\\" \\\", \
SqrtBox[FractionBox[RowBox[{\\\"1\\\", \\\"-\\\", \\\"f\\\"}], \
RowBox[{RowBox[{\\\"1.0204881578749`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"-\\\
\", RowBox[{\\\"2.0204881578749`\\\", \\\" \\\", \\\"f\\\"}], \\\"+\\\", \
RowBox[{\\\"1.`\\\", \\\" \\\", SuperscriptBox[\\\"f\\\", \\\"2\\\"]}]}]]]}], \
RowBox[{RowBox[{\\\"-\\\", \\\"1.0223564824318556`\\\"}], \\\"+\\\", RowBox[{\
\\\"1.`\\\", \\\" \\\", \\\"f\\\"}]}]]}]\\)\[NoBreak] has evaluated to \
non-numerical values for all sampling points in the region with boundaries \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0.15915494309189535`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", ButtonNote -> \
\\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7088084946849957`*^9, 3.708808721255191*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \\\"::\\\", \\\"inumr\
\\\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7088084946849957`*^9, 3.7088087212559557`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.708808514834064*^9, 3.7088087255625973`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fitting using numerical integration to find \[Gamma]", "Section",
 CellChangeTimes->{{3.708801569052305*^9, 3.708801572913825*^9}, {
  3.708801615268572*^9, 3.708801620740752*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i2", "*", 
        RowBox[{"surfen", "[", "f", "]"}]}], " ", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f", "\[Rule]", " ", "f2"}], ",", " ", 
         RowBox[{"l1", "\[Rule]", " ", "81"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{"-", "0.8"}], ",", ".2"}], "}"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0.01"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"f2", ",", "0.1", ",", "0.9"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.708724621953125*^9, 3.708724761522072*^9}, {
  3.70872480589922*^9, 3.7087248664765368`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`f2$$ = 0.24400000000000002`, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`f2$$], 0.1, 0.9}}, Typeset`size$$ = {
    360., {119., 123.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`f2$110235$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`f2$$ = 0.1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`f2$$, $CellContext`f2$110235$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        ReplaceAll[$CellContext`i2 $CellContext`surfen[$CellContext`f], \
{$CellContext`f -> $CellContext`f2$$, $CellContext`l1 -> 
          81}], {$CellContext`\[Theta], -0.8, 0.2}, PlotRange -> {0, 0.01}], 
      "Specifications" :> {{$CellContext`f2$$, 0.1, 0.9}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{407., {162., 169.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7087246448683662`*^9, 3.7087246600614147`*^9}, {
  3.708724696189116*^9, 3.7087247623446608`*^9}, {3.708724809393359*^9, 
  3.70872481690619*^9}, {3.708724859926804*^9, 3.708724867121851*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma] unknown so do fitting", "Subsection",
 CellChangeTimes->{{3.708801746357512*^9, 3.708801756269313*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Inner", "[", 
   RowBox[{"List", ",", "th", ",", "y", ",", "List"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.70880199995011*^9, 3.7088020234711018`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]", "=", "1"}]], "Input",
 CellChangeTimes->{{3.7088035930065393`*^9, 3.708803594147077*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.708803594917656*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"i2", "*", 
   RowBox[{"surfen", "[", "f", "]"}]}], "/.", 
  RowBox[{"{", " ", 
   RowBox[{"l1", "\[Rule]", "81"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"-", "1.`"}], "+", 
     RowBox[{"1.`", " ", "f"}], "+", 
     RowBox[{"0.028036722387579052`", " ", "\[Theta]"}]}]]}], 
  "7.588525787764529`", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", "14.632680345539791`"}], "+", 
      RowBox[{"34.61164643982465`", " ", 
       SuperscriptBox["f", "3"]}], "-", 
      RowBox[{"102.90211213459769`", " ", "\[Theta]"}], "-", 
      RowBox[{"180.91088631258387`", " ", 
       SuperscriptBox["\[Theta]", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["f", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"10.397737407848581`", "\[VeryThinSpace]", "+", 
         RowBox[{"158.26084334624832`", " ", "\[Theta]"}]}], ")"}]}], "+", 
      RowBox[{"f", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "30.37670350213284`"}], "-", 
         RowBox[{"55.358731211650664`", " ", "\[Theta]"}], "+", 
         RowBox[{"180.91088631258387`", " ", 
          SuperscriptBox["\[Theta]", "2"]}]}], ")"}]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1.`"}], "+", "f"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1.0204881578749`"}], "+", 
        RowBox[{"1.`", " ", "f"}]}], ")"}]}]], "-", 
    RowBox[{"116.1297`", " ", 
     RowBox[{"(", 
      TagBox[GridBox[{
         {"\[Piecewise]", GridBox[{
            {
             RowBox[{"2", " ", "f", " ", "\[Pi]"}], 
             RowBox[{"f", "\[LessEqual]", 
              FractionBox["1", 
               RowBox[{"2", " ", "\[Pi]"}]]}]},
            {"1", 
             RowBox[{"f", ">", 
              FractionBox["1", 
               RowBox[{"2", " ", "\[Pi]"}]]}]},
            {"0", 
             TagBox["True",
              "PiecewiseDefault",
              AutoDelete->True]}
           },
           AllowedDimensions->{2, Automatic},
           Editable->True,
           
           GridBoxAlignment->{
            "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{1.}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.84]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}},
           Selectable->True]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}},
           "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.35]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       "Piecewise",
       DeleteWithContents->True,
       Editable->False,
       SelectWithContents->True,
       Selectable->False], ")"}]}]}]], " ", 
  SqrtBox[
   FractionBox[
    RowBox[{"1", "-", "f"}], 
    RowBox[{"1.0204881578749`", "\[VeryThinSpace]", "-", 
     RowBox[{"2.0204881578749`", " ", "f"}], "+", 
     RowBox[{"1.`", " ", 
      SuperscriptBox["f", "2"]}]}]]], " ", 
  RowBox[{"(", 
   RowBox[{"1.`", "\[VeryThinSpace]", "+", 
    RowBox[{"1.`", " ", 
     SuperscriptBox["f", "2"]}], "+", 
    RowBox[{"f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2.`"}], "+", 
       RowBox[{"0.028036722387579052`", " ", "\[Theta]"}]}], ")"}]}], "-", 
    RowBox[{"0.028036722387579052`", " ", "\[Theta]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.708803716524363*^9, 3.708803974923134*^9, 
  3.7088053920902843`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"\[Theta]_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"i2", "*", 
     RowBox[{"surfen", "[", "f", "]"}]}], "/.", 
    RowBox[{"{", " ", 
     RowBox[{"l1", "\[Rule]", "81"}], "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "[", 
   RowBox[{"func", "[", "\[Theta]", "]"}], "]"}], "/.", 
  RowBox[{"\[Theta]", "\[Rule]", 
   RowBox[{"-", "0.8"}]}]}], "\[IndentingNewLine]", 
 RowBox[{" "}]}], "Input",
 CellChangeTimes->{{3.708803553649461*^9, 3.7088035794334173`*^9}, 
   3.708803614562723*^9, {3.708803732019368*^9, 3.708803732482813*^9}, {
   3.708803806491425*^9, 3.708803809338908*^9}, {3.708803990356944*^9, 
   3.708804040932516*^9}, {3.7088043430787783`*^9, 3.7088043739187098`*^9}, {
   3.70880444815152*^9, 3.7088044821612377`*^9}, {3.708805239989018*^9, 
   3.708805280085033*^9}, {3.7088054064859743`*^9, 3.708805413069615*^9}, {
   3.708805679087658*^9, 3.708805693960271*^9}, {3.708805729704256*^9, 
   3.7088057584881067`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"7.588525787764529`", " ", 
    SuperscriptBox["2.718281828459045`", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "729.6644247671732`"}], " ", "f"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "48.09395787791533`"}], "+", 
        RowBox[{"129.6932487072414`", " ", "f"}], "-", 
        RowBox[{"116.21093726915008`", " ", 
         SuperscriptBox["f", "2"]}], "+", 
        RowBox[{"34.61164643982465`", " ", 
         SuperscriptBox["f", "3"]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.`"}], "+", "f"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.0204881578749`"}], "+", 
          RowBox[{"1.`", " ", "f"}]}], ")"}]}]]}]], " ", 
    RowBox[{"(", 
     RowBox[{"1.0224293779100633`", "\[VeryThinSpace]", "-", 
      RowBox[{"2.022429377910063`", " ", "f"}], "+", 
      RowBox[{"1.`", " ", 
       SuperscriptBox["f", "2"]}]}], ")"}], " ", 
    SqrtBox[
     FractionBox[
      RowBox[{"1.`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.`", " ", "f"}]}], 
      RowBox[{"1.0204881578749`", "\[VeryThinSpace]", "-", 
       RowBox[{"2.0204881578749`", " ", "f"}], "+", 
       RowBox[{"1.`", " ", 
        SuperscriptBox["f", "2"]}]}]]]}], 
   RowBox[{
    RowBox[{"-", "1.0224293779100633`"}], "+", 
    RowBox[{"1.`", " ", "f"}]}]]}]], "Output",
 CellChangeTimes->{{3.708804460816242*^9, 3.708804482652503*^9}, {
   3.7088052501476717`*^9, 3.708805281390704*^9}, {3.7088053952515707`*^9, 
   3.7088054136421843`*^9}, 3.708805594423524*^9, {3.708805731129332*^9, 
   3.708805759151638*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"func", "[", "\[Theta]", "]"}], "/.", 
    RowBox[{"\[Theta]", "\[Rule]", 
     RowBox[{"-", "0.7"}]}]}], " ", ",", " ", 
   RowBox[{"{", 
    RowBox[{"f", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7088040010006733`*^9, 3.708804003340859*^9}, {
   3.7088040473323507`*^9, 3.708804105821257*^9}, {3.7088041588693542`*^9, 
   3.708804194077908*^9}, {3.708805436877881*^9, 3.708805437262569*^9}, {
   3.708805628319092*^9, 3.7088056286153507`*^9}, 3.7088056649037237`*^9, {
   3.708805787000299*^9, 3.708805820720701*^9}}],

Cell[BoxData["5.4342088298199865`*^-16"], "Output",
 CellChangeTimes->{{3.708804004966613*^9, 3.708804106267681*^9}, {
   3.708804184269355*^9, 3.708804194630107*^9}, {3.708805418163403*^9, 
   3.70880543833169*^9}, 3.708805597520617*^9, 3.708805628977174*^9, 
   3.708805665444049*^9, {3.708805803732731*^9, 3.708805821198456*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"-", "0.8"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"f", ",", "0", ",", ".1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.708803621918311*^9, 3.7088036265859127`*^9}, {
  3.708803686562196*^9, 3.708803689147579*^9}, {3.708803736058838*^9, 
  3.70880373881033*^9}, {3.708803818851206*^9, 3.708803832651009*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \
\[NoBreak]\\!\\(\\*RowBox[{\\\"ConditionalExpression\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"398.2533044077858`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \\\"116.1297`\\\"}], \\\" \
\\\", RowBox[{\\\"Min\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \
RowBox[{SqrtBox[\\\"f\\\"], \\\" \\\", SqrtBox[RowBox[{\\\"Times\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}]]}]}], \\\"]\\\"}]}]], \\\" \\\", \
SqrtBox[RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"1\\\", \\\"-\\\", \\\"f\\\"}], \
\\\")\\\"}], \\\" \\\", \\\"f\\\"}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{FractionBox[RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"14.33890264440833`\\\", \\\" \\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"14\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"+\\\", RowBox[{\\\"3.632115445395205`\\\", \\\
\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \\\"f\\\", \
\\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\")\
\\\"}]}], RowBox[{SqrtBox[RowBox[{\\\"f\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"1.0204881578749`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\
\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \
RowBox[{\\\"1.`\\\", \\\" \\\", \\\"f\\\"}], \\\"+\\\", \
RowBox[{\\\"0.028036722387579052`\\\", \\\" \\\", \\\"\[Theta]\\\"}]}], \\\")\
\\\"}]}]], \\\"+\\\", \
FractionBox[RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"14.33890264440833`\\\", \\\" \\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"13\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}], \\\"+\\\", RowBox[{RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"18\\\", \\\"\[RightSkeleton]\\\"}], \\\" \\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}]}]}]], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"5\\\", \\\"\[RightSkeleton]\\\"}], \\\"+\\\", RowBox[{\\\"\[LeftSkeleton]\
\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]}], \\\")\\\"}]}], \
RowBox[{SqrtBox[RowBox[{\\\"f\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"1.0204881578749`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\
\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1.`\\\"}], \\\"+\\\", \
RowBox[{\\\"1.`\\\", \\\" \\\", \\\"f\\\"}], \\\"+\\\", \
RowBox[{\\\"0.028036722387579052`\\\", \\\" \\\", \\\"\[Theta]\\\"}]}], \\\")\
\\\"}]}]]}], \\\")\\\"}]}], \\\",\\\", RowBox[{\\\"0\\\", \\\"<\\\", \
\\\"f\\\", \\\"<\\\", \\\"1.`\\\"}]}], \\\"]\\\"}]\\)\[NoBreak] has evaluated \
to non-numerical values for all sampling points in the region with boundaries \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"0.1`\\\"}], \\\"}\\\"}], \\\"}\\\"}]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", \
ButtonNote -> \\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.708803826777893*^9, 3.708803833095833*^9}}],

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"func", "[", 
    RowBox[{"-", "0.8`"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"f", ",", "0", ",", "0.1`"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.708803689547626*^9, 3.7088037393739967`*^9, {3.708803811850836*^9, 
   3.708803833098248*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
With fixed surface tension, use the following to evaluate numerical integral\
\>", "Subsection",
 CellChangeTimes->{{3.708801706725012*^9, 3.7088017253653507`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{
    RowBox[{"Reap", "[", 
     RowBox[{"For", " ", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", 
        RowBox[{"Length", "[", "data", "]"}]}], ",", " ", 
       RowBox[{"i", "++"}], ",", " ", 
       RowBox[{"Sow", "[", " ", 
        RowBox[{
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i2", "*", 
             RowBox[{"surfen", "[", "f", "]"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Theta]", "\[Rule]", " ", 
               RowBox[{"data", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"l1", "\[Rule]", "81"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"f", ",", " ", "0", ",", " ", 
             FractionBox["1", 
              RowBox[{"2", "\[Pi]"}]]}], "}"}]}], "]"}], " ", "+", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i2", "*", "surfconst"}], "/.", 
            RowBox[{"\[Theta]", "\[Rule]", " ", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"f", ",", 
             FractionBox["1", 
              RowBox[{"2", "\[Pi]"}]], ",", "1"}], "}"}]}], "]"}]}], " ", 
        "]"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7085247636438932`*^9, 3.708524805435935*^9}, 
   3.708525179530694*^9, {3.708711171189457*^9, 3.708711291882419*^9}, {
   3.7087113982751102`*^9, 3.708711400129888*^9}, {3.70871164335956*^9, 
   3.708711645804482*^9}, {3.708797806847639*^9, 3.7087978215817127`*^9}, {
   3.708797854300658*^9, 3.708797860125265*^9}, {3.708797916348941*^9, 
   3.7087979647725697`*^9}, {3.7087981089493732`*^9, 3.708798110044973*^9}, {
   3.7087981965020647`*^9, 3.708798198222378*^9}, 3.70879823937484*^9, {
   3.708798352959797*^9, 3.708798355623605*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1215, 1000},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 145, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[750, 27, 456, 10, 32, "Input"],
Cell[1209, 39, 237, 3, 32, "Output"]
}, Open  ]],
Cell[1461, 45, 131, 2, 32, "Input"],
Cell[1595, 49, 348, 9, 32, "Input"],
Cell[1946, 60, 692, 21, 76, "Input"],
Cell[2641, 83, 686, 21, 76, "Input"],
Cell[3330, 106, 524, 11, 55, "Input"],
Cell[CellGroupData[{
Cell[3879, 121, 855, 20, 55, "Input"],
Cell[4737, 143, 406, 8, 34, "Output"]
}, Open  ]],
Cell[5158, 154, 279, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[5462, 166, 322, 8, 32, "Input"],
Cell[5787, 176, 792, 23, 97, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6616, 204, 542, 14, 56, "Input"],
Cell[7161, 220, 984, 29, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8182, 254, 213, 4, 32, "Input"],
Cell[8398, 260, 1346, 41, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9781, 306, 540, 16, 32, "Input"],
Cell[10324, 324, 1923, 57, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12284, 386, 1555, 45, 110, "Input"],
Cell[13842, 433, 1154, 40, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15033, 478, 1208, 40, 109, "Input"],
Cell[16244, 520, 1171, 41, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17452, 566, 488, 12, 32, "Input"],
Cell[17943, 580, 827, 22, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18819, 608, 136, 1, 65, "Section"],
Cell[18958, 611, 140, 2, 33, "Text"],
Cell[19101, 615, 175, 2, 33, "Text"],
Cell[19279, 619, 635, 10, 33, "Text"],
Cell[19917, 631, 438, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[20380, 646, 218, 5, 32, "Input"],
Cell[20601, 653, 265, 4, 32, "Output"]
}, Open  ]],
Cell[20881, 660, 595, 17, 32, "Input"],
Cell[21479, 679, 720, 21, 32, "Input"],
Cell[22202, 702, 986, 28, 32, "Input"],
Cell[23191, 732, 941, 27, 32, "Input"],
Cell[24135, 761, 301, 8, 32, "Input"],
Cell[24439, 771, 224, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[24688, 781, 183, 3, 32, "Input"],
Cell[24874, 786, 5882, 108, 235, "Output"]
}, Open  ]],
Cell[30771, 897, 1077, 24, 57, "Input"],
Cell[31851, 923, 769, 22, 32, "Input"],
Cell[CellGroupData[{
Cell[32645, 949, 311, 6, 32, "Input"],
Cell[32959, 957, 2483, 38, 135, "Message"],
Cell[35445, 997, 2483, 38, 135, "Message"],
Cell[37931, 1037, 2220, 34, 110, "Message"],
Cell[40154, 1073, 592, 12, 23, "Message"],
Cell[40749, 1087, 101, 1, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40899, 1094, 186, 2, 66, "Section"],
Cell[CellGroupData[{
Cell[41110, 1100, 840, 23, 55, "Input"],
Cell[41953, 1125, 1951, 37, 348, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43941, 1167, 118, 1, 45, "Subsection"],
Cell[44062, 1170, 196, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[44283, 1179, 124, 2, 32, "Input"],
Cell[44410, 1183, 70, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44517, 1189, 168, 5, 32, "Input"],
Cell[44688, 1196, 4098, 113, 150, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48823, 1314, 1070, 24, 99, "Input"],
Cell[49896, 1340, 1652, 43, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51585, 1388, 625, 13, 32, "Input"],
Cell[52213, 1403, 332, 4, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52582, 1412, 411, 9, 32, "Input"],
Cell[52996, 1423, 4519, 65, 181, "Message"],
Cell[57518, 1490, 323, 9, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57890, 1505, 174, 3, 45, "Subsection"],
Cell[58067, 1510, 2127, 51, 161, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
